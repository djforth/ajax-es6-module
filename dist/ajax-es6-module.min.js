(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),_=require("lodash"),AjaxPromises=function(){function e(t){_classCallCheck(this,e),this.uri=t||null,this.state="GET",this.data=[],this.headers=[]}return _createClass(e,[{key:"addHeaders",value:function(e){_.isArray(e)?this.headers=_.union(e,this.headers):this.headers.push(e)}},{key:"addID",value:function(e){return _.isUndefined(e)?this.uri:this.uri.match(/.json/)?this.uri.replace(".json","/"+e+".json"):this.uri+"/"+e}},{key:"addUrl",value:function(e){if(!_.isString(e))throw new Error("URL must be a string");this.uri=e}},{key:"create",value:function(e,t){return this.state="POST",new Promise(function(n,s){this.getRequest(n,s,t,e)}.bind(this))}},{key:"destroy",value:function(e,t){return this.state="DELETE",this.getCSRF(),this.addHeaders("X-Http-Method-Override","delete"),new Promise(function(n,s){this.getRequest(n,s,t,null,e)}.bind(this))}},{key:"fetch",value:function(e){return this.state="GET",new Promise(function(t,n){this.getRequest(t,n,e)}.bind(this))}},{key:"getCSRF",value:function(){token=document.querySelector("meta[name=csrf-token]"),token&&this.headers.push({header:"X-CSRF-Token",value:token.content})}},{key:"getData",value:function(){return this.data}},{key:"getID",value:function(e,t){return t?t:e.id}},{key:"getRequest",value:function(e,t,n,s,r){if(this.url)throw new Error("URL not set");var a=this.setRequest(e,t,n),i=s?JSON.stringify(s):null;a.open(this.state,this.addID(r),!0),a.send(i)}},{key:"parseData",value:function(e){return _.isUndefined(e)||(this.data=JSON.parse(e)),this.data}},{key:"update",value:function(e,t,n){return this.state="PUT",new Promise(function(s,r){this.getRequest(s,r,n,e,this.getID(e,t))}.bind(this))}},{key:"readyState",value:function(e,t,n){200!==e.status&&0!==e.status&&n(new Error(e.statusText)),4===e.readyState&&(this.parseData(e.responseText),t(this.getData()))}},{key:"setHeaders",value:function(e,t){t&&this.addHeaders(t),_.forEach(this.headers,function(t){e.setRequestHeader(t.header,t.value)})}},{key:"setProgress",value:function(e,t){t(e.lengthComputable?{percent:e.loaded/e.total*100,loaded:e.loaded,total:e.total}:{percent:100,loaded:e.loaded,total:e.loaded})}},{key:"setRequest",value:function(e,t,n){var s=new XMLHttpRequest;return _.isFunction(n)&&(s.onprogress=function(){this.setProgress(s,n)}.bind(this)),s.onreadystatechange=function(){this.readyState(s,e,t)}.bind(this),s.onerror=function(){t(Error("Network Error"))},s}}]),e}();module.exports=AjaxPromises;

},{"lodash":undefined}]},{},[1]);
