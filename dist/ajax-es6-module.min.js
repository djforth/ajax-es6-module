(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),_=require("lodash"),AjaxPromises=function(){function e(t){_classCallCheck(this,e),this.uri=t||null,this.state="GET",this.data=[],this.headers=[]}return _createClass(e,[{key:"addRailsJSHeader",value:function(){this.addHeaders([{header:"Content-type",value:"application/json"},{header:"accept",value:"*/*;q=0.5, text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"}])}},{key:"addHeaders",value:function(e){_.isArray(e)?this.headers=_.union(e,this.headers):this.headers.push(e)}},{key:"addID",value:function(e){return _.isUndefined(e)?this.uri:this.uri.match(/.json/)?this.uri.replace(".json","/"+e+".json"):this.uri+"/"+e}},{key:"addUrl",value:function(e){if(!_.isString(e))throw new Error("URL must be a string");this.uri=e}},{key:"create",value:function(e,t){return this.state="POST",new Promise(function(a,n){this.getRequest(a,n,t,e)}.bind(this))}},{key:"destroy",value:function(e,t){this.state="POST";var a=this.getCSRF();this.addRailsJSHeader(),this.addHeaders({header:"X-Http-Method-Override",value:"delete"});var n={_method:"delete"};return n[a.param]=a.token,new Promise(function(a,s){this.getRequest(a,s,t,n,e)}.bind(this))}},{key:"fetch",value:function(e){return this.state="GET",new Promise(function(t,a){this.getRequest(t,a,e)}.bind(this))}},{key:"getCSRF",value:function(){var e=document.querySelector("meta[name=csrf-token]"),t=document.querySelector("meta[name=csrf-param]");return e&&this.headers.push({header:"X-CSRF-Token",value:e.content}),{token:e.content,param:t.content}}},{key:"getData",value:function(){return this.data}},{key:"getID",value:function(e,t){return t?t:e.id}},{key:"getRequest",value:function(e,t,a,n,s){if(this.url)throw new Error("URL not set");var r=this.setRequest(e,t,a),i=n?JSON.stringify(n):null;r.open(this.state,this.addID(s),!0),this.setHeaders(r),r.send(i)}},{key:"parseData",value:function(e){return _.isUndefined(e)||(this.data=JSON.parse(e)),this.data}},{key:"update",value:function(e,t,a){return this.state="PUT",new Promise(function(n,s){this.getRequest(n,s,a,e,this.getID(e,t))}.bind(this))}},{key:"readyState",value:function(e,t,a){200!==e.status&&0!==e.status&&a(new Error(e.statusText)),4===e.readyState&&(this.parseData(e.responseText),t(this.getData()))}},{key:"setHeaders",value:function(e,t){t&&this.addHeaders(t),_.forEach(this.headers,function(t){e.setRequestHeader(t.header,t.value)})}},{key:"setProgress",value:function(e,t){t(e.lengthComputable?{percent:e.loaded/e.total*100,loaded:e.loaded,total:e.total}:{percent:100,loaded:e.loaded,total:e.loaded})}},{key:"setRequest",value:function(e,t,a){var n=new XMLHttpRequest;return _.isFunction(a)&&(n.onprogress=function(){_.isFunction(a)&&this.setProgress(n,a)}.bind(this)),n.onreadystatechange=function(){this.readyState(n,e,t)}.bind(this),n.onerror=function(){t(Error("Network Error"))},n}}]),e}();module.exports=AjaxPromises;

},{"lodash":undefined}]},{},[1]);
